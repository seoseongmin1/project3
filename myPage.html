<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>경북 길라잡이 : 마이페이지</title>
    <style>
      .body {
        font-family: Arial, sans-serif;
        background-color: #ffffff;
        margin: 0;
        padding: 0;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }
      .header {
        display: flex;
        align-items: center;
        padding: 10px;
        background-color: #ffffff; /* 원하는 배경색 설정 */
      }
      .logo {
        display: inline-block;
      }

      .search-container {
        display: flex;
        align-items: center; /* 수직 가운데 정렬 */
        justify-content: center; /* 수평 가운데 정렬 */
        background-color: #fff; /* 검색 박스 배경색 */
        border: 1px solid #ccc; /* 검색 박스 테두리 */
        padding: 10px;
        max-width: 700px;
        width: 100%;
        margin-left: 50px;
        border-radius: 10px;
      }
      .buttons {
        display: flex;
        align-items: center;
        margin-left: 120px;
        text-decoration: none;
      }
      .buttons a {
        color: #000000;
      }
      #title {
        border: none;
        padding: 5px;
        flex: 1; /* 나머지 공간을 채우도록 설정 */
      }

      #searchButton {
        background-color: #ffffff; /* 검색 버튼 배경색 */
        color: #fff; /* 검색 버튼 텍스트색 */
        border: none;
        padding: 5px 10px;
        cursor: pointer;
      }

      .search-form {
        display: flex;
        flex: 1; /* 전체 공간을 차지하도록 설정 */
      }
      .custom-button {
        margin-left: 30px; /* 버튼 사이 간격 조정 */
        width: 100px;
        height: 50px;
        border-radius: 10px;
        border: #ffffff;
        background-color: #ffffff;
        text-decoration: none;
        color: #000000;
      }

      .container {
        display: flex;
      }

      .menu {
        width: 360px;
        height: 550px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background-color: #ffffff; /* 배경색 지정 (선택적) */
      }

      .menu li {
        list-style: none;
        margin: 50px 0;
        font-size: large;
      }

      .menu a {
        text-decoration: none;
        color: black; /* 링크 색상 지정 (선택적) */
        padding: 10px; /* 링크간의 간격 조절 (선택적) */
      }

      .info {
        display: flex;
        padding: 50px;
      }

      .withdraw {
        list-style: none;
      }
      .withdraw a {
        color: #7d7d7d;
      }

      a {
        text-decoration: none;
      }
    </style>
  </head>
  <body>
    <!-- 자바스크립트로 로그인 확인 -->
    <div class="header">
      <div class="logo">
        <a href="Main.html">
          <img
            src="https://postfiles.pstatic.net/MjAyMzEwMTNfMjYw/MDAxNjk3MTYzNjcwMDYy.XPihVSwY_hfqEmHzfC0ToqtTn8FVtTvsFqmXfFzll94g.qHLCwIalJGLgLIH3TmP6WdFGhIxTDLHeAq0zM2cSbDMg.PNG.dnj1510/%EA%B2%BD%EB%B6%81_%EA%B8%B8%EB%9D%AC%EC%9E%A1%EC%9D%B4.png?type=w580"
            alt="로고"
          />
        </a>
      </div>
      <div class="search-container">
        <form
          id="searchForm"
          name="searchForm"
          method="post"
          onsubmit="submitForm(event)"
          class="search-form"
        >
          <input type="hidden" id="cate_top" />
          <input
            type="text"
            name="title"
            id="title"
            title="검색어 입력"
            placeholder="검색어를 입력하세요"
            class="flex-1"
          />
          <button type="submit" id="searchButton">
            <img
              src="https://postfiles.pstatic.net/MjAyMzExMDVfMjkw/MDAxNjk5MTc2ODE4MjY1.ip9TlhvhZz4ZCGy8tKMO6vKr-3kOG8T-Zy5MBXG6Yogg.zVE42yT4Hf3MUp96DK93HZOmDslaj_YV0W2uJ0Z7QEUg.PNG.dnj1510/search.png?type=w580"
              alt="검색"
            />
          </button>
        </form>
      </div>
      <div class="buttons">
        <button class="custom-button">
          <a href="/wishlist.html">위시리스트</a>
        </button>
        <button class="custom-button">
          <a href="/myPage.html">마이페이지</a>
        </button>
        <button class="custom-button" id="logoutBtn" style="display: none">
            <a href="/logout">로그아웃</a>
          </button>
          <button class="custom-button" id="loginBtn">
            <a href="/login.html">로그인</a>
        <button class="custom-button"><a href="/cs.html">고객센터</a></button>
      </div>
    </div>
    <div class="container">
      <div class="menu">
        <li><a href="MyPage.html">내 프로필</a></li>
        <li><a href="MyPage.html">추가</a></li>
        <li><a href="MyPage.html">정보</a></li>
      </div>
      <div class="info">
        <div class="userinfo">
          <h2>기본정보</h2>
          <p><strong>이름:</strong> <span id="name"></span></p>
          <p><strong>전화번호:</strong> <span id="phoneNumber"></span></p>
          <p><strong>이메일:</strong> <span id="email"></span></p>
          <div class="withdraw">
            <li><a href="Withdraw">회원탈퇴></a></li>
          </div>
        </div>
      </div>
    </div>
    <script>
      var currentSlide = 0; // 현재 슬라이드 인덱스

      // 검색 폼 제출 시
document.getElementById("searchForm").addEventListener("submit", function (event) {
    event.preventDefault();

    // 검색어 가져오기
    const searchKeyword = document.getElementById("title").value;

    // 입력이 없을 경우 경고 메시지 표시
    if (!searchKeyword.trim()) {
        alert("검색어를 입력하세요.");
        return;
    }

    // 검색 요청 보내기
    fetch("/search.do", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
        },
        body: JSON.stringify({ title: searchKeyword }),
    })
    .then((response) => response.json())
    .then((data) => {
        // 검색 결과를 받아와서 동적으로 UI에 추가
        // 여기서는 결과를 search-result.html로 이동하는 방식으로 변경
        window.location.href = `/search-result.html?results=${encodeURIComponent(JSON.stringify(data))}`;
    })
    .catch((error) => {
        console.error("Error searching:", error);
    });
});

      function checkLoginStatus() {
        fetch("/currentUser")
          .then((response) => response.json())
          .then((data) => {
            const user = data.username;

            // 여기에서 user 상태에 따라 버튼을 표시/숨김 처리
            if (user) {
              document.getElementById("logoutBtn").style.display = "block";
              document.getElementById("loginBtn").style.display = "none";
            } else {
              document.getElementById("logoutBtn").style.display = "none";
              document.getElementById("loginBtn").style.display = "block";
            }
          })
          .catch((error) => {
            console.error("Error checking login status:", error);
          });
      }

      // 페이지 로드 시 사용자 로그인 상태 확인
      window.onload = checkLoginStatus;
    </script>
  </body>
</html>
